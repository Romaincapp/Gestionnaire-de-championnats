<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestionnaire de Championnats</title>
    <link rel="stylesheet"  href="styles.css">


</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ† Gestionnaire de Championnats</h1>
            <p>PlantÃ© !!! avec â¤ï¸ par Romain testÃ© avec style par Rachel</p>
        </div>

        <!-- ONGLETS -->
        <div class="tabs-container" id="tabsContainer">
            <div class="tabs" id="tabs">
                <button class="tab active" onclick="switchTab(1)" data-day="1">
                    JournÃ©e 1
                </button>
                 <button class="add-day-btn" onclick="addNewDay()" title="Ajouter une journÃ©e">+</button>
                <button class="tab general-ranking" onclick="switchToGeneralRanking()" data-tab="general" id="generalRankingTab">
                    ğŸ† Classement
                </button>
                <button class="tab multisport-ranking" onclick="switchToMultisportRanking()" data-tab="multisport" id="multisportTab" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; display: none;">
                    ğŸ… Multisport
                </button>
            </div>
        </div>

        <div class="content">
            <!-- CONFIGURATION -->
            <div style="background: linear-gradient(135deg, #16a085, #1abc9c); padding: 12px; border-radius: 8px; margin-bottom: 15px; color: white;">
                <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap; justify-content: center;">
                    <div id="divisionConfigContainer" style="display: flex; align-items: center; gap: 8px;">
                        <span style="font-weight: bold; font-size: 14px;">âš™ï¸ Divisions:</span>
                        <select id="divisionConfig" onchange="updateDivisionConfig()" style="padding: 6px 10px; border-radius: 5px; border: none; font-size: 13px;">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3" selected>3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                        </select>
                    </div>
                    <div id="courtConfigContainer" style="display: flex; align-items: center; gap: 8px;">
                        <span style="font-weight: bold; font-size: 14px;">ğŸ¾ Terrains:</span>
                        <select id="courtConfig" onchange="updateCourtConfig()" style="padding: 6px 10px; border-radius: 5px; border: none; font-size: 13px;">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4" selected>4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="8">8</option>
                            <option value="10">10</option>
                        </select>
                    </div>
                    <button id="applyConfigBtn" class="btn" onclick="applyConfiguration()" style="background: white; color: #16a085; font-weight: bold; padding: 6px 15px; font-size: 13px;">
                        âœ… Appliquer
                    </button>
                </div>
                <div id="courtAssignmentInfo" style="margin-top: 10px; padding: 8px; background: rgba(255,255,255,0.2); border-radius: 5px; font-size: 12px; text-align: center;">
                    <!-- Information sur l'attribution des terrains sera ajoutÃ©e ici -->
                </div>
            </div>

            <!-- MODE CHRONO -->
            <div id="chronoModeSection" style="display: none;">
                <div class="section" style="background: linear-gradient(135deg, #16a085 0%, #1abc9c 100%); padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <h2 style="color: white; text-align: center; margin-bottom: 20px;">â±ï¸ Gestion des SÃ©ries de Course</h2>

                    <!-- Gestion des sÃ©ries -->
                    <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h3 style="margin: 0; color: #2c3e50;">ğŸƒ Ã‰preuves et SÃ©ries</h3>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <button class="btn" onclick="showParticipantsManager()" style="background: linear-gradient(135deg, #16a085, #1abc9c); color: white;">
                                    ğŸ‘¥ Ajouter des participants
                                </button>
                                <button class="btn" onclick="showAddEventModal()" style="background: linear-gradient(135deg, #e67e22, #d35400); color: white;">
                                    ğŸ… Nouvelle Ã‰preuve
                                </button>
                                <button class="btn btn-success" onclick="showAddSerieModal()">
                                    â• Nouvelle SÃ©rie
                                </button>
                                <button class="btn" onclick="showOverallChronoRanking()" style="background: linear-gradient(135deg, #16a085, #1abc9c); color: white;">
                                    ğŸ† Classement GÃ©nÃ©ral
                                </button>
                                <button class="btn" onclick="exportChronoCompetition()" style="background: linear-gradient(135deg, #27ae60, #2ecc71); color: white;">
                                    ğŸ’¾ Exporter CompÃ©tition
                                </button>
                                <button class="btn" onclick="importChronoCompetition()" style="background: linear-gradient(135deg, #3498db, #2980b9); color: white;">
                                    ğŸ“¥ Importer CompÃ©tition
                                </button>
                                <button class="btn" onclick="printChronoCompetition()" style="background: linear-gradient(135deg, #9b59b6, #8e44ad); color: white;">
                                    ğŸ–¨ï¸ Imprimer
                                </button>
                            </div>
                        </div>

                        <div id="eventsList" style="display: grid; gap: 20px;">
                            <!-- Les Ã©preuves et sÃ©ries seront affichÃ©es ici -->
                        </div>

                        <div id="noEventsMessage" style="text-align: center; padding: 40px; color: #7f8c8d;">
                            Aucune Ã©preuve crÃ©Ã©e. Cliquez sur "ğŸ… Nouvelle Ã‰preuve" pour commencer.
                        </div>
                    </div>

                    <!-- Classement gÃ©nÃ©ral chrono -->
                    <div id="overallChronoRanking" style="display: none; margin-top: 20px;">
                        <!-- Le classement gÃ©nÃ©ral sera gÃ©nÃ©rÃ© ici -->
                    </div>

                    <div id="raceInterface" style="display: none; margin-top: 20px;">
                        <!-- Interface de gestion de course sera gÃ©nÃ©rÃ©e ici -->
                    </div>
                </div>
            </div>

            <!-- CONTENU JOURNÃ‰E -->
            <div class="tab-content day-content active" id="day-1">
                <!-- SÃ©lecteur de type de journÃ©e pour J1 (sera initialisÃ© par JS) -->
                <div class="day-type-selector" id="day-type-selector-1" style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px; padding: 8px 12px; background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); border-radius: 8px; color: white;">
                    <span style="font-size: 13px; font-weight: 500;">ğŸ¾ Mode:</span>
                    <select id="day-type-select-1" onchange="handleDayTypeChange(1, this.value)" style="padding: 6px 10px; border-radius: 6px; border: none; font-size: 13px; cursor: pointer; background: rgba(255,255,255,0.95); color: #333; min-width: 140px;">
                        <option value="championship" selected>ğŸ† Matchs</option>
                        <option value="chrono">â±ï¸ Courses</option>
                    </select>
                    <span id="day-type-label-1" style="font-size: 11px; opacity: 0.9; margin-left: auto;">Championnat</span>
                </div>
                
                <div id="championship-section-1" style="display: block;">
                <div class="section">
                    <h2 style="cursor: pointer; user-select: none; display: flex; align-items: center; gap: 8px;" onclick="toggleDayHub(1)">
                        <span id="day-hub-icon-1" class="collapse-icon" style="font-size: 14px; transition: transform 0.3s ease; display: inline-block;">â–¼</span>
                        <span>ğŸ‘¥ Gestion des Joueurs - JournÃ©e 1</span>
                    </h2>

                    <div id="day-hub-content-1">
                    <!-- Ligne unique de boutons -->
                    <div style="display: flex; align-items: center; gap: 6px; flex-wrap: wrap;">
                        <!-- Ajout joueurs -->
                        <button onclick="showAddPlayerModal(1)" style="display: inline-flex; align-items: center; gap: 4px; padding: 8px 12px; font-size: 12px; background: #10b981; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            â• Joueurs
                        </button>
                        <button onclick="showImportPlayersModal(1)" style="display: inline-flex; align-items: center; gap: 4px; padding: 8px 10px; font-size: 12px; background: #f1f5f9; color: #475569; border: 1px solid #cbd5e1; border-radius: 6px; cursor: pointer; font-weight: 500;">
                            ğŸ“¥ Importer
                        </button>
                        <!-- Actions matchs -->
                        <button onclick="showMatchGenerationModal(1)" style="display: inline-flex; align-items: center; gap: 4px; padding: 8px 12px; font-size: 12px; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500;">
                            ğŸ¯ Matchs
                        </button>
                        <button onclick="togglePoolSection(1)" id="show-pool-btn-1" style="display: inline-flex; align-items: center; gap: 4px; padding: 8px 12px; font-size: 12px; background: #f59e0b; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500;">
                            ğŸŠ Poules
                        </button>
                        <button onclick="updateRankingsForDay(1)" style="display: inline-flex; align-items: center; gap: 4px; padding: 8px 12px; font-size: 12px; background: #8b5cf6; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500;">
                            ğŸ† Classements
                        </button>
                        <button onclick="showByeManagementModal(1)" style="display: inline-flex; align-items: center; gap: 4px; padding: 8px 12px; font-size: 12px; background: #14b8a6; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500;">
                            ğŸ‘‹ BYE
                        </button>
                        <button onclick="toggleForfaitButtons()" id="forfait-toggle-btn-1" style="display: inline-flex; align-items: center; gap: 4px; padding: 8px 12px; font-size: 12px; background: #64748b; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500;">
                            âš ï¸ Actions
                        </button>
                        <!-- SÃ©parateur visuel -->
                        <span style="color: #cbd5e1;">|</span>
                        <!-- Actions donnÃ©es -->
                        <button onclick="exportChampionship()" style="display: inline-flex; align-items: center; gap: 4px; padding: 8px 10px; font-size: 12px; background: #f1f5f9; color: #475569; border: 1px solid #cbd5e1; border-radius: 6px; cursor: pointer; font-weight: 500;">
                            ğŸ’¾ Exporter
                        </button>
                        <button onclick="showImportModal()" style="display: inline-flex; align-items: center; gap: 4px; padding: 8px 10px; font-size: 12px; background: #f1f5f9; color: #475569; border: 1px solid #cbd5e1; border-radius: 6px; cursor: pointer; font-weight: 500;">
                            ğŸ“¥ Importer
                        </button>
                        <button onclick="showPrintOptionsModal(1)" style="display: inline-flex; align-items: center; gap: 4px; padding: 8px 10px; font-size: 12px; background: #f1f5f9; color: #475569; border: 1px solid #cbd5e1; border-radius: 6px; cursor: pointer; font-weight: 500;" title="Options d'impression (feuilles de match, Boccia, rÃ©caps)">
                            ğŸ–¨ï¸
                        </button>
                        <button onclick="clearAllData()" style="display: inline-flex; align-items: center; gap: 4px; padding: 8px 10px; font-size: 12px; background: #fef2f2; color: #dc2626; border: 1px solid #fecaca; border-radius: 6px; cursor: pointer; font-weight: 500;">
                            ğŸ—‘ï¸
                        </button>
                    </div>
                    <!-- Inputs cachÃ©s pour import fichier -->
                    <input type="file" id="fileInput" accept=".xlsx,.xls,.csv" style="display: none;">
                    <select id="bulkDivision" style="display: none;">
                        <option value="1">Division 1</option>
                        <option value="2">Division 2</option>
                        <option value="3">Division 3</option>
                    </select>
                    <select id="playerDivision" style="display: none;">
                        <option value="1">Division 1</option>
                        <option value="2">Division 2</option>
                        <option value="3">Division 3</option>
                    </select>
                    <input type="hidden" id="playerName">
                    </div><!-- Fin day-hub-content-1 -->
                </div>
                <!-- Fin de la section "Gestion des Joueurs" -->

                <div class="divisions" id="divisions-1">
                    <!-- Les divisions seront gÃ©nÃ©rÃ©es dynamiquement -->
                </div>

                <div class="rankings-section" id="rankings-1" style="display: none;">
                    <div class="rankings-header">
                        <div class="rankings-title">ğŸ† Classements JournÃ©e 1</div>
                        <div class="rankings-toggle" style="flex-wrap: wrap; gap: 5px;">
                            <button class="toggle-btn active" onclick="showRankings('points')">Par Points</button>
                            <button class="toggle-btn" onclick="showRankings('winrate')">Par % Victoires</button>
                            <button class="toggle-btn" onclick="openRankingInNewWindow(1)" style="background: linear-gradient(135deg, #9b59b6, #8e44ad); color: white;">ğŸ“º Afficher</button>
                            <button class="toggle-btn" onclick="showCompleteDayRanking(1)" style="background: linear-gradient(135deg, #27ae60, #2ecc71); color: white;">ğŸ“Š Complet</button>
                        </div>
                    </div>
                    <div id="rankingsContent-1"></div>
                </div>

                <div class="stats" id="stats-1" style="display: none;">
                    <h3>ğŸ“Š Statistiques JournÃ©e 1</h3>
                    <div class="stats-grid" id="statsContent-1"></div>
                </div>
                </div><!-- Fin championship-section-1 -->
                
                <!-- SECTION CHRONO pour J1 -->
                <div id="chrono-section-1" style="display: none;">
                    <div class="section" style="background: linear-gradient(135deg, #16a085 0%, #1abc9c 100%);">
                        <h2 style="color: white;">â±ï¸ Gestion des Courses - JournÃ©e 1</h2>
                        <div id="chrono-content-1" style="background: white; padding: 20px; border-radius: 10px; margin-top: 15px;">
                            <p style="text-align: center; color: #7f8c8d;">Chargement de l'interface chrono...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CLASSEMENT GÃ‰NÃ‰RAL -->
            <div class="tab-content general-content" id="general-ranking">
                <div class="section general-ranking-section">
                    <h2 style="cursor: pointer; user-select: none; display: flex; align-items: center; gap: 8px;" onclick="toggleGeneralHub()">
                        <span id="general-hub-icon" class="collapse-icon" style="font-size: 14px; transition: transform 0.3s ease; display: inline-block;">â–¼</span>
                        <span>ğŸ† Classement GÃ©nÃ©ral du Championnat</span>
                    </h2>

                    <div id="general-hub-content">
                    <div class="general-stats" id="generalStats">
                        <!-- Stats gÃ©nÃ©rales seront gÃ©nÃ©rÃ©es ici -->
                    </div>

                    <div class="control-buttons" style="margin-bottom: 30px; flex-wrap: wrap; gap: 8px;">
                        <button class="btn btn-warning" onclick="updateGeneralRanking()" style="padding: 8px 12px; font-size: 13px;">
                            ğŸ”„ Mettre Ã  jour
                        </button>
                        <button class="btn" onclick="openRankingInNewWindow('general')" style="background: linear-gradient(135deg, #9b59b6, #8e44ad); padding: 8px 12px; font-size: 13px;">
                            ğŸ“º Afficher
                        </button>
                        <button class="btn btn-success" onclick="exportGeneralRanking()" style="padding: 8px 12px; font-size: 13px;">
                            ğŸ“Š JSON
                        </button>
                        <button class="btn" onclick="exportGeneralRankingToPDF()" style="background: linear-gradient(135deg, #e74c3c, #c0392b); padding: 8px 12px; font-size: 13px;">
                            ğŸ“„ PDF
                        </button>
                        <button class="btn" onclick="exportGeneralRankingToHTML()" style="background: linear-gradient(135deg, #27ae60, #2ecc71); padding: 8px 12px; font-size: 13px;">
                            ğŸ“„ HTML
                        </button>
                    </div>
                    </div><!-- Fin general-hub-content -->

                    <div id="generalRankingContent">
                        <div class="empty-state">
                            Terminez au moins un match dans une journÃ©e pour voir le classement gÃ©nÃ©ral
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- CLASSEMENT MULTISPORT -->
            <div class="tab-content multisport-content" id="multisport-ranking" style="display: none;">
                <div class="section multisport-ranking-section">
                    <h2 style="cursor: pointer; user-select: none; display: flex; align-items: center; gap: 8px;" onclick="toggleMultisportHub()">
                        <span id="multisport-hub-icon" class="collapse-icon" style="font-size: 14px; transition: transform 0.3s ease; display: inline-block;">â–¼</span>
                        <span>ğŸ… Classement Multisport (Championship + Chrono)</span>
                    </h2>
                    
                    <div id="multisport-hub-content">
                        <div class="multisport-info" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                            <p style="margin: 0; font-size: 14px;">
                                ğŸ¯ Ce classement combine les points des journÃ©es <strong>Championship</strong> (matchs) et <strong>Chrono</strong> (courses).
                                <br>ğŸ¾ Championship: 3 pts par victoire | â±ï¸ Chrono: 20 pts pour le 1er, 17 pour le 2Ã¨me, etc.
                            </p>
                        </div>
                        
                        <div class="control-buttons" style="margin-bottom: 30px; flex-wrap: wrap; gap: 8px;">
                            <button class="btn btn-warning" onclick="updateMultisportRanking()" style="padding: 8px 12px; font-size: 13px;">
                                ğŸ”„ Mettre Ã  jour
                            </button>
                            <button class="btn" onclick="openMultisportRankingInNewWindow()" style="background: linear-gradient(135deg, #9b59b6, #8e44ad); color: white; padding: 8px 12px; font-size: 13px;">
                                ğŸ“º Afficher
                            </button>
                            <button class="btn btn-success" onclick="exportMultisportRanking()" style="padding: 8px 12px; font-size: 13px;">
                                ğŸ“Š Exporter JSON
                            </button>
                        </div>
                    </div>
                    
                    <div id="multisportRankingContent">
                        <div class="empty-state">
                            Activez le mode Multisport sur au moins une journÃ©e et saisissez des rÃ©sultats pour voir le classement
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODALS -->
    <div id="importModal" class="modal">
        <div class="modal-content">
            <h3>Importer un Championnat</h3>
            <div style="margin-bottom: 20px;">
                <div class="file-input-wrapper">
                    <input type="file" id="importFileInput" accept=".json">
                    <label for="importFileInput" class="file-input-label">
                        ğŸ“ Choisir un fichier JSON
                    </label>
                </div>
            </div>
            <p style="margin: 15px 0; color: #7f8c8d; font-size: 14px;">
                âš ï¸ L'import remplacera complÃ¨tement le championnat actuel
            </p>
            <div style="margin: 20px 0; padding: 15px; background: #f0f9ff; border-radius: 8px; border: 1px solid #bae6fd;">
                <p style="margin: 0 0 10px 0; font-size: 13px; color: #0369a1;">
                    ğŸ“ <strong>Import multi-journÃ©es :</strong> SÃ©lectionnez plusieurs fichiers JSON (un par journÃ©e)
                </p>
                <button onclick="showMultiDayImportModal(); closeImportModal();" class="btn" style="background: linear-gradient(135deg, #0ea5e9, #0284c7); color: white; width: 100%;">
                    ğŸ“‚ Importer plusieurs journÃ©es
                </button>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-danger" onclick="closeImportModal()">Annuler</button>
                <button class="btn btn-success" onclick="processImport()">Importer</button>
            </div>
        </div>
    </div>

    <!-- Modal Ajout Joueurs -->
    <div id="addPlayerModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <h3 style="margin-top: 0; display: flex; align-items: center; gap: 8px;">â• Ajouter des joueurs <span id="addPlayerDayLabel" style="font-size: 14px; color: #64748b;"></span></h3>

            <!-- Ajout individuel -->
            <div style="padding: 12px; background: #f8fafc; border-radius: 8px; margin-bottom: 12px;">
                <div style="font-size: 12px; color: #64748b; margin-bottom: 8px; font-weight: 500;">Ajout individuel</div>
                <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap;">
                    <input type="text" id="addPlayerName" placeholder="Nom du joueur" style="flex: 1; min-width: 150px; padding: 8px 12px; border: 1px solid #cbd5e1; border-radius: 6px; font-size: 13px;" onkeypress="if(event.key==='Enter')addPlayerFromModal()">
                    <select id="addPlayerClub" onchange="handleClubSelectChange(this, 'addPlayerClubCustom')" style="padding: 8px; border: 1px solid #cbd5e1; border-radius: 6px; font-size: 13px; min-width: 150px;">
                        <option value="">-- Club --</option>
                    </select>
                    <select id="addPlayerDivision" style="padding: 8px; border: 1px solid #cbd5e1; border-radius: 6px; font-size: 13px;"></select>
                    <button onclick="addPlayerFromModal()" style="padding: 8px 16px; background: #10b981; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; font-size: 13px;">Ajouter</button>
                </div>
                <input type="text" id="addPlayerClubCustom" placeholder="Nouveau club..." style="display: none; width: 100%; margin-top: 8px; padding: 8px 12px; border: 1px solid #cbd5e1; border-radius: 6px; font-size: 13px;">
            </div>

            <!-- Import en masse -->
            <div style="padding: 12px; background: #f8fafc; border-radius: 8px; margin-bottom: 12px;">
                <div style="font-size: 12px; color: #64748b; margin-bottom: 8px; font-weight: 500;">Import en masse</div>
                <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap;">
                    <div class="file-input-wrapper" style="display: inline-block;">
                        <input type="file" id="modalFileInput" accept=".xlsx,.xls,.csv" onchange="handleModalFileInput(event)">
                        <label for="modalFileInput" style="display: inline-flex; align-items: center; gap: 4px; padding: 8px 12px; font-size: 12px; background: #3b82f6; color: white; border-radius: 6px; cursor: pointer; font-weight: 500;">
                            ğŸ“ CSV/Excel
                        </label>
                    </div>
                    <span style="color: #94a3b8; font-size: 11px;">A=Nom, B=Division</span>
                    <span style="color: #cbd5e1;">|</span>
                    <select id="modalBulkDivision" style="padding: 8px; border: 1px solid #cbd5e1; border-radius: 6px; font-size: 13px;"></select>
                    <button onclick="showBulkFromModal()" style="padding: 8px 12px; background: #8b5cf6; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; font-size: 12px;">
                        ğŸ“‹ Coller liste
                    </button>
                </div>
            </div>

            <div style="display: flex; justify-content: space-between; padding-top: 12px; border-top: 1px solid #e2e8f0;">
                <button onclick="showClubManagementModal()" style="padding: 8px 16px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500;">ğŸ¢ GÃ©rer les clubs</button>
                <button onclick="closeAddPlayerModal()" style="padding: 8px 16px; background: #f1f5f9; color: #475569; border: 1px solid #cbd5e1; border-radius: 6px; cursor: pointer; font-weight: 500;">Fermer</button>
            </div>
        </div>
    </div>

    <div id="bulkModal" class="modal">
        <div class="modal-content" style="max-width: 600px; max-height: 85vh; display: flex; flex-direction: column;">
            <h3 style="margin-top: 0;">Ajouter plusieurs joueurs</h3>
            <p style="margin-bottom: 12px; color: #7f8c8d; font-size: 14px;">
                Collez la liste des noms (un par ligne) pour la <strong id="selectedDivision">Division 1</strong> :
            </p>
            <div style="margin-bottom: 12px;">
                <label style="font-size: 12px; color: #64748b; margin-right: 8px;">Club (optionnel) :</label>
                <select id="bulkClubSelect" style="padding: 6px 10px; border: 1px solid #cbd5e1; border-radius: 6px; font-size: 13px; min-width: 150px;">
                    <option value="">-- Aucun --</option>
                </select>
                <input type="text" id="bulkClubCustom" style="display: none; padding: 6px 10px; border: 1px solid #cbd5e1; border-radius: 6px; font-size: 13px; margin-top: 5px; width: 100%;" placeholder="Nouveau club...">
            </div>
            <textarea id="bulkText" placeholder="Joueur 1&#10;Joueur 2&#10;Joueur 3&#10;..."
                      style="width: 100%; flex: 1; min-height: 250px; max-height: 400px; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; resize: vertical; font-size: 14px;"></textarea>
            <div class="modal-buttons" style="position: sticky; bottom: 0; background: white; padding: 15px 0 0 0; margin-top: 15px; border-top: 2px solid #ddd;">
                <button class="btn btn-danger" onclick="closeBulkModal()">Annuler</button>
                <button class="btn btn-success" onclick="addBulkPlayers()">Ajouter tous</button>
            </div>
        </div>
    </div>

    <div id="playerModal" class="player-modal">
        <div class="player-modal-content">
            <div class="player-modal-header">
                <div class="player-name-title" id="playerNameTitle"></div>
                <button class="close-modal" onclick="closePlayerModal()">Ã—</button>
            </div>
            <div class="player-overview" id="playerOverview"></div>
            <div class="matches-history">
                <h3 style="color: #2c3e50; margin-bottom: 15px;">ğŸ“‹ Historique des matchs</h3>
                <div id="playerMatches"></div>
            </div>
        </div>
    </div>

    <!-- Modal Ã‰preuve -->
    <div id="eventModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <h3 id="eventModalTitle">ğŸ… Nouvelle Ã‰preuve</h3>
            <div style="display: grid; gap: 15px;">
                <div>
                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">ğŸ“ Nom de l'Ã©preuve:</label>
                    <input type="text" id="eventName" placeholder="Ex: 400m Dames, 1500m Hommes, Relais 4x100..." style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd;">
                </div>

                <div>
                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">ğŸƒ Type de sport:</label>
                    <select id="eventSportType" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd;">
                        <option value="running">Course Ã  pied</option>
                        <option value="cycling">VÃ©lo</option>
                        <option value="swimming">Natation</option>
                    </select>
                </div>

                <div>
                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">ğŸ“ Distance (en mÃ¨tres):</label>
                    <input type="number" id="eventDistance" value="400" min="1" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd;">
                </div>

                <div>
                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">ğŸ”„ Type de course:</label>
                    <select id="eventRaceType" onchange="updateEventRelayOptions()" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd;">
                        <option value="individual">Individuelle</option>
                        <option value="relay">Relais</option>
                        <option value="interclub">Interclub</option>
                    </select>
                </div>

                <div id="eventRelayDurationSection" style="display: none;">
                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">â° DurÃ©e du relais (minutes):</label>
                    <input type="number" id="eventRelayDuration" value="60" min="1" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd;">
                </div>

                <div id="eventInterclubSection" style="display: none;">
                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">ğŸ† BarÃ¨me de points:</label>
                    <input type="text" id="eventInterclubPoints" value="10,8,6,5,4,3,2,1" placeholder="10,8,6,5,4,3,2,1" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd;">
                    <p style="margin: 5px 0 0 0; font-size: 12px; color: #7f8c8d;">
                        Points attribuÃ©s par place (1er, 2Ã¨me, 3Ã¨me...). SÃ©parez par des virgules.
                    </p>
                </div>

                <div id="eventLaneModeSection" style="background: linear-gradient(135deg, #3498db, #2980b9); padding: 15px; border-radius: 8px; margin-top: 5px;">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; color: white;">
                        <input type="checkbox" id="eventLaneMode" style="width: 20px; height: 20px; cursor: pointer;">
                        <span style="font-weight: bold;">ğŸŠ Mode Couloirs (1-9)</span>
                    </label>
                    <p style="margin: 8px 0 0 0; font-size: 12px; color: rgba(255,255,255,0.9);">
                        Saisie rapide : les touches 1-9 arrÃªtent le couloir correspondant (pas besoin d'appuyer sur EntrÃ©e). Compatible avec tous les types de course.
                    </p>
                </div>

                <div style="background: #e8f4f8; padding: 15px; border-radius: 8px; border-left: 4px solid #3498db;">
                    <p style="margin: 0; font-size: 14px; color: #2c3e50;">
                        <strong>â„¹ï¸ Info:</strong> Une Ã©preuve peut contenir plusieurs sÃ©ries. Par exemple, "400m Dames" peut avoir 3 sÃ©ries de 8 coureuses chacune.
                    </p>
                </div>
            </div>

            <div class="modal-buttons">
                <button class="btn btn-danger" onclick="closeEventModal()">Annuler</button>
                <button class="btn btn-success" onclick="saveEvent()">CrÃ©er l'Ã©preuve</button>
            </div>
        </div>
    </div>

    <!-- Modal SÃ©rie -->
    <div id="serieModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <h3 id="serieModalTitle">Nouvelle SÃ©rie</h3>
            <div style="display: grid; gap: 15px;">
                <div>
                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">ğŸ… Ã‰preuve:</label>
                    <select id="serieEventId" onchange="updateSerieFromEvent()" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd; background: #e8f4f8; font-weight: bold;">
                        <option value="">-- SÃ©lectionnez une Ã©preuve --</option>
                        <!-- Les Ã©preuves seront chargÃ©es ici -->
                    </select>
                    <p style="margin: 5px 0 0 0; font-size: 12px; color: #7f8c8d;">
                        SÃ©lectionnez l'Ã©preuve Ã  laquelle cette sÃ©rie appartient (ex: 400m Dames - SÃ©rie 1)
                    </p>
                </div>

                <div>
                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">ğŸ“ Nom de la sÃ©rie:</label>
                    <input type="text" id="serieName" placeholder="Ex: SÃ©rie 1, SÃ©rie A, Finale..." style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd;">
                </div>

                <div>
                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">ğŸ‘¥ Participants:</label>
                    <div style="max-height: 300px; overflow-y: auto; border: 2px solid #ddd; border-radius: 5px; padding: 15px; background: #f8f9fa;">
                        <div id="participantsCheckboxList">
                            <!-- Les checkboxes des participants seront gÃ©nÃ©rÃ©es ici -->
                        </div>
                    </div>
                </div>

                <!-- Option Mode Couloirs -->
                <div id="laneModeContainer" style="display: none; background: linear-gradient(135deg, #3498db, #2980b9); padding: 15px; border-radius: 8px;">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; color: white;">
                        <input type="checkbox" id="serieLaneMode" onchange="toggleLaneSelectors()" style="width: 20px; height: 20px; cursor: pointer;">
                        <span style="font-weight: bold;">ğŸŠ Mode Couloirs (1-9)</span>
                    </label>
                    <p style="margin: 8px 0 0 30px; font-size: 12px; color: #ecf0f1;">
                        Activez ce mode pour les courses en couloirs (natation, athlÃ©tisme). Chaque touche 1-9 du clavier arrÃªte instantanÃ©ment le chrono du couloir correspondant.
                    </p>
                    <div id="laneAssignmentInfo" style="display: none; margin-top: 10px; padding: 10px; background: rgba(255,255,255,0.15); border-radius: 5px;">
                        <p style="margin: 0; font-size: 12px; color: white;">
                            Assignez un couloir (1-9) Ã  chaque participant cochÃ© ci-dessus.
                        </p>
                    </div>
                </div>

                <div style="background: #fff3cd; padding: 12px; border-radius: 8px; border-left: 4px solid #f39c12;">
                    <p style="margin: 0; font-size: 13px; color: #856404;">
                        <strong>ğŸ’¡ Astuce:</strong> Les paramÃ¨tres (distance, type de sport) sont hÃ©ritÃ©s de l'Ã©preuve sÃ©lectionnÃ©e.
                    </p>
                </div>
            </div>

            <div class="modal-buttons">
                <button class="btn btn-danger" onclick="closeSerieModal()">Annuler</button>
                <button class="btn btn-success" onclick="saveSerie()">Enregistrer</button>
            </div>
        </div>
    </div>

    <!-- Modal Gestion des Participants -->
    <div id="participantsManagerModal" class="modal">
        <div class="modal-content" style="max-width: 1000px;">
            <h3>ğŸ‘¥ Gestion des Participants</h3>

            <!-- Formulaire d'ajout de participant -->
            <div style="background: linear-gradient(135deg, #16a085, #1abc9c); padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h4 style="color: white; margin: 0;">â• Ajouter un participant</h4>
                    <button class="btn" onclick="showBulkParticipantsModal()" style="background: white; color: #16a085; font-weight: bold;">
                        ğŸ“‹ Ajout en masse
                    </button>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                    <div>
                        <label style="color: white; font-weight: bold; display: block; margin-bottom: 5px;">ğŸƒ PrÃ©nom / Ã‰quipe:</label>
                        <input type="text" id="participantName" placeholder="Ex: Jean Dupont ou Ã‰quipe A" style="width: 100%; padding: 10px; border-radius: 5px; border: none;">
                    </div>
                    <div>
                        <label style="color: white; font-weight: bold; display: block; margin-bottom: 5px;">ğŸ“‹ CatÃ©gorie:</label>
                        <input type="text" id="participantCategory" placeholder="Ex: U18, Senior, Dames..." style="width: 100%; padding: 10px; border-radius: 5px; border: none;">
                    </div>
                    <div>
                        <label style="color: white; font-weight: bold; display: block; margin-bottom: 5px;">ğŸ”¢ Dossard:</label>
                        <input type="text" id="participantBib" placeholder="Ex: 42" style="width: 100%; padding: 10px; border-radius: 5px; border: none;">
                    </div>
                </div>
                <!-- Champs supplÃ©mentaires optionnels -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                    <div>
                        <label style="color: white; font-weight: bold; display: block; margin-bottom: 5px;">ğŸ‚ Ã‚ge (optionnel):</label>
                        <input type="number" id="participantAge" placeholder="Ex: 28" style="width: 100%; padding: 10px; border-radius: 5px; border: none;">
                    </div>
                    <div>
                        <label style="color: white; font-weight: bold; display: block; margin-bottom: 5px;">ğŸŒ NationalitÃ© (optionnel):</label>
                        <input type="text" id="participantNationality" placeholder="Ex: France, Belgique..." style="width: 100%; padding: 10px; border-radius: 5px; border: none;">
                    </div>
                    <div>
                        <label style="color: white; font-weight: bold; display: block; margin-bottom: 5px;">ğŸ… Club (optionnel):</label>
                        <input type="text" id="participantClub" placeholder="Ex: AC Paris" style="width: 100%; padding: 10px; border-radius: 5px; border: none;">
                    </div>
                </div>
                <button class="btn btn-success" onclick="addParticipantToChrono()" style="margin-top: 15px; width: 100%;">
                    âœ… Ajouter
                </button>
            </div>

            <!-- Liste des participants -->
            <div style="background: white; padding: 20px; border-radius: 10px; border: 2px solid #ddd;">
                <h4 style="margin: 0 0 15px 0; color: #2c3e50;">ğŸ“‹ Liste des participants</h4>
                <div id="participantsList" style="max-height: 400px; overflow-y: auto;">
                    <!-- La liste des participants sera affichÃ©e ici -->
                </div>
            </div>

            <div class="modal-buttons" style="margin-top: 20px;">
                <button class="btn" onclick="closeParticipantsManager()" style="background: linear-gradient(135deg, #16a085, #1abc9c); color: white;">
                    âœ… Fermer
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Ã‰dition Participant -->
    <div id="editParticipantModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <h3>âœï¸ Ã‰diter le participant</h3>
            <div style="display: grid; gap: 15px;">
                <div>
                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">ğŸƒ PrÃ©nom / Ã‰quipe:</label>
                    <input type="text" id="editParticipantName" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd;">
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div>
                        <label style="font-weight: bold; display: block; margin-bottom: 5px;">ğŸ“‹ CatÃ©gorie:</label>
                        <input type="text" id="editParticipantCategory" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd;">
                    </div>
                    <div>
                        <label style="font-weight: bold; display: block; margin-bottom: 5px;">ğŸ”¢ Dossard:</label>
                        <input type="text" id="editParticipantBib" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd;">
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                    <div>
                        <label style="font-weight: bold; display: block; margin-bottom: 5px;">ğŸ‚ Ã‚ge:</label>
                        <input type="number" id="editParticipantAge" placeholder="Optionnel" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd;">
                    </div>
                    <div>
                        <label style="font-weight: bold; display: block; margin-bottom: 5px;">ğŸŒ NationalitÃ©:</label>
                        <input type="text" id="editParticipantNationality" placeholder="Optionnel" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd;">
                    </div>
                    <div>
                        <label style="font-weight: bold; display: block; margin-bottom: 5px;">ğŸ… Club:</label>
                        <input type="text" id="editParticipantClub" placeholder="Optionnel" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd;">
                    </div>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-danger" onclick="closeEditParticipantModal()">Annuler</button>
                <button class="btn btn-success" onclick="saveParticipantEdit()">Enregistrer</button>
            </div>
        </div>
    </div>

    <!-- Modal Ã‰dition Temps Participant -->
    <div id="editTimeModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <h3>âœï¸ Ã‰diter les performances</h3>
            <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #f39c12;">
                <p style="margin: 0; font-size: 14px; color: #856404;">
                    <strong>âš ï¸ Attention:</strong> Vous modifiez manuellement les donnÃ©es de performance. Ces changements remplaceront les valeurs chronomÃ©trÃ©es automatiquement.
                </p>
            </div>
            <div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                <div style="margin-bottom: 10px;">
                    <strong>Participant:</strong> <span id="editTimeParticipantName" style="color: #2c3e50;"></span>
                </div>
                <div style="margin-bottom: 10px;">
                    <strong>Dossard:</strong> <span id="editTimeParticipantBib" style="color: #e67e22; font-weight: bold;"></span>
                </div>
                <div style="margin-bottom: 10px;">
                    <strong>Temps actuel:</strong> <span id="editTimeCurrentTime" style="color: #27ae60; font-family: monospace; font-weight: bold;"></span>
                </div>
                <div style="margin-bottom: 10px;">
                    <strong>Tours actuels:</strong> <span id="editTimeCurrentLaps" style="color: #3498db; font-weight: bold;"></span>
                </div>
                <div>
                    <strong>Distance par tour:</strong> <span id="editTimeDistancePerLap" style="color: #16a085; font-weight: bold;"></span>
                </div>
            </div>
            <div style="display: grid; gap: 15px;">
                <div>
                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">ğŸ”„ Nombre de tours:</label>
                    <input type="number" id="editTimeLaps" min="0" value="0" style="width: 100%; padding: 12px; border-radius: 5px; border: 2px solid #3498db; text-align: center; font-size: 20px; font-weight: bold;">
                    <div style="font-size: 12px; color: #7f8c8d; margin-top: 5px; text-align: center;">
                        Distance totale: <span id="editTimeTotalDistance" style="font-weight: bold; color: #27ae60;">0 km</span>
                    </div>
                </div>

                <div>
                    <label style="font-weight: bold; display: block; margin-bottom: 5px;">â±ï¸ Nouveau temps:</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 10px;">
                        <div>
                            <label style="font-size: 12px; color: #7f8c8d; display: block; margin-bottom: 3px;">Heures</label>
                            <input type="number" id="editTimeHours" min="0" max="23" value="0" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd; text-align: center; font-size: 18px; font-weight: bold;">
                        </div>
                        <div>
                            <label style="font-size: 12px; color: #7f8c8d; display: block; margin-bottom: 3px;">Minutes</label>
                            <input type="number" id="editTimeMinutes" min="0" max="59" value="0" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd; text-align: center; font-size: 18px; font-weight: bold;">
                        </div>
                        <div>
                            <label style="font-size: 12px; color: #7f8c8d; display: block; margin-bottom: 3px;">Secondes</label>
                            <input type="number" id="editTimeSeconds" min="0" max="59" value="0" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd; text-align: center; font-size: 18px; font-weight: bold;">
                        </div>
                        <div>
                            <label style="font-size: 12px; color: #7f8c8d; display: block; margin-bottom: 3px;">CentiÃ¨mes</label>
                            <input type="number" id="editTimeCentiseconds" min="0" max="99" value="0" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ddd; text-align: center; font-size: 18px; font-weight: bold;">
                        </div>
                    </div>
                </div>
                <div style="background: #e8f4f8; padding: 12px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 12px; color: #7f8c8d; margin-bottom: 5px;">AperÃ§u du nouveau temps:</div>
                    <div id="editTimePreview" style="font-size: 32px; font-weight: bold; color: #2c3e50; font-family: monospace;">00:00:00.00</div>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-danger" onclick="closeEditTimeModal()">Annuler</button>
                <button class="btn btn-success" onclick="saveEditedTime()">âœ… Enregistrer les modifications</button>
            </div>
        </div>
    </div>

    <!-- Modal Ajout en masse Participants -->
    <div id="bulkParticipantsModal" class="modal">
        <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
            <h3 style="margin-top: 0;">ğŸ“‹ Ajout en masse de participants</h3>

            <!-- SÃ©lection des colonnes -->
            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 2px solid #ddd;">
                <h4 style="margin: 0 0 10px 0; color: #2c3e50; font-size: 16px;">âš™ï¸ SÃ©lectionnez les colonnes Ã  importer</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px;">
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <input type="checkbox" id="bulkCol_bib" checked disabled style="width: 18px; height: 18px; cursor: not-allowed;">
                        <span style="font-weight: bold; font-size: 14px;">ğŸ”¢ Dossard <span style="color: #e74c3c;">*</span></span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <input type="checkbox" id="bulkCol_name" checked disabled style="width: 18px; height: 18px; cursor: not-allowed;">
                        <span style="font-weight: bold; font-size: 14px;">ğŸƒ Nom <span style="color: #e74c3c;">*</span></span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <input type="checkbox" id="bulkCol_category" checked disabled style="width: 18px; height: 18px; cursor: not-allowed;">
                        <span style="font-weight: bold; font-size: 14px;">ğŸ“‹ CatÃ©gorie <span style="color: #e74c3c;">*</span></span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <input type="checkbox" id="bulkCol_age" onchange="updateBulkImportFormat()" style="width: 18px; height: 18px;">
                        <span style="font-size: 14px;">ğŸ‚ Ã‚ge</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <input type="checkbox" id="bulkCol_nationality" onchange="updateBulkImportFormat()" style="width: 18px; height: 18px;">
                        <span style="font-size: 14px;">ğŸŒ NationalitÃ©</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <input type="checkbox" id="bulkCol_club" onchange="updateBulkImportFormat()" style="width: 18px; height: 18px;">
                        <span style="font-size: 14px;">ğŸ… Club</span>
                    </label>
                </div>
                <p style="margin: 8px 0 0 0; font-size: 12px; color: #7f8c8d;">
                    <span style="color: #e74c3c;">*</span> Champs obligatoires â€¢ Les autres sont optionnels
                </p>
            </div>

            <div id="bulkImportFormatInfo" style="background: linear-gradient(135deg, #16a085, #1abc9c); padding: 12px; border-radius: 8px; margin-bottom: 15px; color: white;">
                <h4 style="margin: 0 0 8px 0; font-size: 15px;">ğŸ“ Format d'importation</h4>
                <p style="margin: 5px 0; font-size: 13px;">Collez vos donnÃ©es avec <strong>une ligne par participant</strong> dans l'un des formats suivants :</p>
                <div id="bulkFormatExample" style="background: rgba(255,255,255,0.2); padding: 8px; border-radius: 5px; margin-top: 8px; font-family: monospace; font-size: 12px;">
                    <!-- Sera mis Ã  jour dynamiquement -->
                </div>
            </div>

            <div style="margin-bottom: 15px;">
                <label style="font-weight: bold; display: block; margin-bottom: 5px; font-size: 14px;">Collez vos donnÃ©es ici :</label>
                <textarea id="bulkParticipantsText"
                          placeholder="Exemple:&#10;42&#9;Jean Dupont&#9;Senior&#10;43&#9;Marie Martin&#9;U18&#10;44&#9;Ã‰quipe A&#9;Relais&#10;&#10;ou avec virgules:&#10;42,Jean Dupont,Senior&#10;43,Marie Martin,U18"
                          style="width: 100%; height: 180px; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-family: monospace; font-size: 13px; resize: vertical;"></textarea>
            </div>

            <div id="bulkParticipantsPreview" style="display: none; margin-bottom: 15px;">
                <h4 style="color: #2c3e50; margin-bottom: 8px; font-size: 15px;">ğŸ‘€ AperÃ§u (<span id="bulkPreviewCount">0</span> participants)</h4>
                <div style="max-height: 150px; overflow-y: auto; border: 2px solid #ddd; border-radius: 8px; padding: 12px; background: #f8f9fa;">
                    <div id="bulkParticipantsPreviewContent"></div>
                </div>
            </div>

            <div class="modal-buttons" style="position: sticky; bottom: 0; background: white; padding: 15px 0 0 0; margin-top: 15px; border-top: 2px solid #ddd;">
                <button class="btn" onclick="previewBulkParticipants()" style="background: #3498db; color: white;">
                    ğŸ‘ï¸ PrÃ©visualiser
                </button>
                <button class="btn btn-danger" onclick="closeBulkParticipantsModal()">Annuler</button>
                <button class="btn btn-success" onclick="saveBulkParticipants()">
                    âœ… Ajouter tous les participants
                </button>
            </div>
        </div>
    </div>

    <!-- Modal SÃ©lection Type de Classement Chrono -->
    <div id="chronoRankingTypeModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <h3 style="text-align: center; color: #2c3e50; margin-bottom: 20px;">ğŸ† Choisissez le Type de Classement</h3>

            <div style="background: linear-gradient(135deg, #16a085, #1abc9c); color: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center;">
                <p style="margin: 0; font-size: 14px;">SÃ©lectionnez le type de classement que vous souhaitez afficher en fonction de vos Ã©preuves</p>
            </div>

            <div id="rankingTypeOptions" style="display: grid; gap: 15px; max-height: 60vh; overflow-y: auto; padding-right: 10px;">
                <!-- Les options seront gÃ©nÃ©rÃ©es dynamiquement ici -->
            </div>

            <div class="modal-buttons" style="margin-top: 20px;">
                <button class="btn btn-danger" onclick="closeChronoRankingTypeModal()">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal StratÃ©gie PrÃ©-remplissage Poules -->
    <div id="poolPreFillStrategyModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <h3 style="text-align: center; color: #2c3e50; margin-bottom: 20px;">ğŸ¯ StratÃ©gie de PrÃ©-remplissage</h3>

            <!-- Ã‰tape 1 : Choix du mode (rÃ©organiser ou prÃ©-remplir) -->
            <div id="preFillModeSelection" style="display: block;">
                <div style="background: linear-gradient(135deg, #f39c12, #e67e22); color: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center;">
                    <p style="margin: 0; font-size: 14px;">Comment souhaitez-vous remplir cette journÃ©e ?</p>
                </div>

                <div style="display: grid; grid-template-columns: 1fr; gap: 15px;">
                    <!-- RÃ©organiser les joueurs existants -->
                    <div onclick="selectPreFillMode('reorganize')" style="
                        background: linear-gradient(135deg, #3498db, #2980b9);
                        color: white;
                        padding: 25px;
                        border-radius: 10px;
                        cursor: pointer;
                        transition: transform 0.2s, box-shadow 0.2s;
                        border: 3px solid transparent;
                    " onmouseover="this.style.transform='scale(1.02)'; this.style.boxShadow='0 8px 20px rgba(52,152,219,0.4)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none';">
                        <h4 style="margin: 0 0 10px 0; font-size: 20px;">ğŸ”„ RÃ©organiser les joueurs de la journÃ©e prÃ©cÃ©dente</h4>
                        <p style="margin: 0; font-size: 14px; opacity: 0.9;">
                            Reprend TOUS les joueurs de la journÃ©e prÃ©cÃ©dente et les rÃ©organise entre les divisions.<br>
                            <strong>âœ… Garde tous les joueurs</strong> - IdÃ©al pour redistribuer sans perdre personne
                        </p>
                    </div>

                    <!-- PrÃ©-remplir depuis le classement -->
                    <div onclick="selectPreFillMode('prefill')" style="
                        background: linear-gradient(135deg, #9b59b6, #8e44ad);
                        color: white;
                        padding: 25px;
                        border-radius: 10px;
                        cursor: pointer;
                        transition: transform 0.2s, box-shadow 0.2s;
                        border: 3px solid transparent;
                    " onmouseover="this.style.transform='scale(1.02)'; this.style.boxShadow='0 8px 20px rgba(155,89,182,0.4)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none';">
                        <h4 style="margin: 0 0 10px 0; font-size: 20px;">ğŸ“Š PrÃ©-remplir depuis le classement gÃ©nÃ©ral</h4>
                        <p style="margin: 0; font-size: 14px; opacity: 0.9;">
                            Utilise le classement gÃ©nÃ©ral pour remplir cette journÃ©e.<br>
                            <strong>âš ï¸ Peut exclure certains joueurs</strong> selon la stratÃ©gie choisie
                        </p>
                    </div>
                </div>

                <div class="modal-buttons" style="margin-top: 20px;">
                    <button class="btn btn-danger" onclick="closePoolPreFillStrategyModal()">Annuler</button>
                </div>
            </div>

            <!-- Ã‰tape 2 : Choix de la stratÃ©gie -->
            <div id="preFillStrategySelection" style="display: none;">
                <div style="background: linear-gradient(135deg, #f39c12, #e67e22); color: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center;">
                    <p style="margin: 0; font-size: 14px;">Choisissez comment rÃ©partir les joueurs dans les divisions</p>
                </div>

            <div style="display: grid; grid-template-columns: 1fr; gap: 15px;">
                <!-- StratÃ©gie Par Niveau -->
                <div onclick="applyPreFillStrategy('by-level')" style="
                    background: linear-gradient(135deg, #3498db, #2980b9);
                    color: white;
                    padding: 20px;
                    border-radius: 10px;
                    cursor: pointer;
                    transition: transform 0.2s, box-shadow 0.2s;
                    border: 3px solid transparent;
                " onmouseover="this.style.transform='scale(1.02)'; this.style.boxShadow='0 8px 20px rgba(52,152,219,0.4)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none';">
                    <h4 style="margin: 0 0 10px 0; font-size: 18px;">ğŸ¯ Par Niveau</h4>
                    <p style="margin: 0; font-size: 13px; opacity: 0.9;">
                        Les joueurs restent dans leur division, triÃ©s du meilleur au moins bon<br>
                        <strong>Usage :</strong> Simple prÃ©-remplissage, sans changement de division
                    </p>
                </div>

                <!-- StratÃ©gie Serpent -->
                <div onclick="applyPreFillStrategy('snake')" style="
                    background: linear-gradient(135deg, #9b59b6, #8e44ad);
                    color: white;
                    padding: 20px;
                    border-radius: 10px;
                    cursor: pointer;
                    transition: transform 0.2s, box-shadow 0.2s;
                    border: 3px solid transparent;
                " onmouseover="this.style.transform='scale(1.02)'; this.style.boxShadow='0 8px 20px rgba(155,89,182,0.4)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none';">
                    <h4 style="margin: 0 0 10px 0; font-size: 18px;">ğŸ Serpent (Snake Draft)</h4>
                    <p style="margin: 0; font-size: 13px; opacity: 0.9;">
                        Dans chaque division : 1er, dernier, 2e, avant-dernier, 3e... (mÃ©lange forts/faibles)<br>
                        <strong>Usage :</strong> Ã‰quilibrer les poules, Ã©viter que les meilleurs soient ensemble
                    </p>
                </div>

                <!-- StratÃ©gie Mixte -->
                <div onclick="applyPreFillStrategy('balanced')" style="
                    background: linear-gradient(135deg, #27ae60, #2ecc71);
                    color: white;
                    padding: 20px;
                    border-radius: 10px;
                    cursor: pointer;
                    transition: transform 0.2s, box-shadow 0.2s;
                    border: 3px solid transparent;
                " onmouseover="this.style.transform='scale(1.02)'; this.style.boxShadow='0 8px 20px rgba(39,174,96,0.4)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none';">
                    <h4 style="margin: 0 0 10px 0; font-size: 18px;">âš–ï¸ Mixte Ã‰quilibrÃ©</h4>
                    <p style="margin: 0; font-size: 13px; opacity: 0.9;">
                        Dans chaque division : alternance 1 fort, 1 moyen, 1 faible (rÃ©partition Ã©quitable)<br>
                        <strong>Usage :</strong> Poules trÃ¨s Ã©quilibrÃ©es, matchs variÃ©s, tournoi convivial
                    </p>
                </div>

                <!-- StratÃ©gie Ã‰quilibrer (Promotions/RelÃ©gations) -->
                <div onclick="applyPreFillStrategy('rebalance')" style="
                    background: linear-gradient(135deg, #e67e22, #d35400);
                    color: white;
                    padding: 20px;
                    border-radius: 10px;
                    cursor: pointer;
                    transition: transform 0.2s, box-shadow 0.2s;
                    border: 3px solid transparent;
                " onmouseover="this.style.transform='scale(1.02)'; this.style.boxShadow='0 8px 20px rgba(230,126,34,0.4)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none';">
                    <h4 style="margin: 0 0 10px 0; font-size: 18px;">ğŸ”„ Ã‰quilibrer les Divisions</h4>
                    <p style="margin: 0; font-size: 13px; opacity: 0.9;">
                        Promotions/RelÃ©gations : Les meilleurs de chaque division montent, les derniers descendent<br>
                        <strong>Usage :</strong> Maintenir des divisions Ã©quilibrÃ©es tout au long du championnat
                    </p>
                </div>
            </div>

            <div class="modal-buttons" style="margin-top: 20px;">
                <button class="btn btn-secondary" onclick="backToModeSelection()">â¬…ï¸ Retour</button>
                <button class="btn btn-danger" onclick="closePoolPreFillStrategyModal()">Annuler</button>
            </div>
            </div>
        </div>
    </div>

    <!-- Modal Configuration Export PDF Chrono -->
    <div id="chronoPdfConfigModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <h3 style="text-align: center; color: #2c3e50; margin-bottom: 20px;">ğŸ“„ Configuration Export PDF</h3>

            <div style="background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center;">
                <p style="margin: 0; font-size: 14px;">Personnalisez votre export PDF</p>
            </div>

            <!-- Champ personnalisation du titre -->
            <div style="background: white; padding: 20px; border-radius: 10px; border: 2px solid #ddd; margin-bottom: 15px;">
                <h4 style="color: #2c3e50; margin-bottom: 10px;">ğŸ“ Titre du document :</h4>
                <input type="text"
                       id="pdfCustomTitle"
                       placeholder="Entrez un titre personnalisÃ© (optionnel)"
                       style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px; font-family: Arial, sans-serif;">
                <p style="margin: 8px 0 0 0; font-size: 12px; color: #7f8c8d;">
                    ğŸ’¡ Laissez vide pour utiliser le titre par dÃ©faut : <span id="pdfDefaultTitle" style="font-weight: bold; color: #2c3e50;"></span>
                </p>
            </div>

            <!-- SÃ©lection des colonnes -->
            <div style="background: white; padding: 20px; border-radius: 10px; border: 2px solid #ddd;">
                <h4 style="color: #2c3e50; margin-bottom: 15px;">ğŸ“Š Colonnes Ã  inclure :</h4>
                <div id="pdfColumnsCheckboxes" style="display: grid; gap: 12px;">
                    <!-- Les checkboxes seront gÃ©nÃ©rÃ©es dynamiquement ici -->
                </div>
            </div>

            <div class="modal-buttons" style="margin-top: 20px;">
                <button class="btn btn-danger" onclick="closeChronoPdfConfigModal()">Annuler</button>
                <button class="btn btn-success" onclick="confirmChronoPdfExport()">
                    âœ… GÃ©nÃ©rer le PDF
                </button>
            </div>
        </div>
    </div>

    <!-- Modal GÃ©nÃ©ration de Matchs -->
    <div id="matchGenerationModal" class="modal">
        <div class="modal-content" style="max-width: 300px; padding: 15px;">
            <h4 style="text-align: center; color: #2c3e50; margin: 0 0 12px 0; font-size: 14px;">ğŸ¯ GÃ©nÃ©ration de Matchs</h4>

            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;">
                <div onclick="selectMatchGenerationType('round-robin')"
                     style="background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 10px 8px; border-radius: 8px; cursor: pointer; transition: transform 0.2s; text-align: center;"
                     onmouseover="this.style.transform='scale(1.02)';"
                     onmouseout="this.style.transform='scale(1)';">
                    <div style="font-size: 12px; font-weight: 600;">ğŸ”„ Round-Robin</div>
                    <div style="font-size: 10px; opacity: 0.9;">Tous vs tous</div>
                </div>

                <div onclick="selectMatchGenerationType('optimized')"
                     style="background: linear-gradient(135deg, #e67e22, #d35400); color: white; padding: 10px 8px; border-radius: 8px; cursor: pointer; transition: transform 0.2s; text-align: center;"
                     onmouseover="this.style.transform='scale(1.02)';"
                     onmouseout="this.style.transform='scale(1)';">
                    <div style="font-size: 12px; font-weight: 600;">ğŸ² OptimisÃ© 4-10</div>
                    <div style="font-size: 10px; opacity: 0.9;">SchÃ©mas optimisÃ©s</div>
                </div>

                <div onclick="selectMatchGenerationType('court')"
                     style="background: linear-gradient(135deg, #16a085, #1abc9c); color: white; padding: 10px 8px; border-radius: 8px; cursor: pointer; transition: transform 0.2s; text-align: center;"
                     onmouseover="this.style.transform='scale(1.02)';"
                     onmouseout="this.style.transform='scale(1)';">
                    <div style="font-size: 12px; font-weight: 600;">ğŸ¾ Par Terrain</div>
                    <div style="font-size: 10px; opacity: 0.9;">RÃ©partis par court</div>
                </div>

                <div onclick="selectMatchGenerationType('swiss')"
                     style="background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; padding: 10px 8px; border-radius: 8px; cursor: pointer; transition: transform 0.2s; text-align: center;"
                     onmouseover="this.style.transform='scale(1.02)';"
                     onmouseout="this.style.transform='scale(1)';">
                    <div style="font-size: 12px; font-weight: 600;">ğŸ† Swiss System</div>
                    <div style="font-size: 10px; opacity: 0.9;">Par niveau (J2+)</div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 12px;">
                <button class="btn btn-danger" onclick="closeMatchGenerationModal()" style="padding: 6px 12px; font-size: 12px;">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal Classement Complet de JournÃ©e -->
    <div id="completeDayRankingModal" class="modal">
        <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #3498db;">
                <h3 id="completeDayRankingTitle" style="margin: 0; color: #2c3e50;">ğŸ“Š Classement Complet - JournÃ©e 1</h3>
                <button onclick="closeCompleteDayRankingModal()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #7f8c8d;">Ã—</button>
            </div>
            <div id="completeDayRankingContent">
                <!-- Contenu gÃ©nÃ©rÃ© dynamiquement -->
            </div>
            <div style="display: flex; justify-content: center; gap: 10px; margin-top: 20px; padding-top: 15px; border-top: 1px solid #eee; position: sticky; bottom: 0; background: white;">
                <button onclick="closeCompleteDayRankingModal()" class="btn btn-secondary" style="padding: 8px 20px;">Fermer</button>
                <button onclick="openCompleteRankingInNewWindow()" class="btn" style="padding: 8px 20px; background: linear-gradient(135deg, #9b59b6, #8e44ad); color: white;">ğŸ“º Afficher</button>
            </div>
        </div>
    </div>

        <!-- ============================================ -->
        <!-- MODULES REFACTORISES - Architecture modulaire -->
        <!-- ============================================ -->
        
        <!-- 1. Modules de base -->
        <script src="src/config.iife.js"></script>
        <script src="src/utils.iife.js"></script>
        <script src="src/notifications.iife.js"></script>
        <script src="src/state.iife.js"></script>
        
        <!-- 2. Module Multisport -->
        <script src="src/multisport.iife.js"></script>
        
        <!-- 3. Module Clubs -->
        <script src="src/clubs.iife.js"></script>
        
        <!-- 4. Module Joueurs -->
        <script src="src/players.iife.js"></script>
        
        <!-- 4. Modules des 3 modes UI -->
        <script src="src/ui.iife.js"></script>           <!-- UI Generale -->
        <script src="src/matches.iife.js"></script>      <!-- Mode Championship -->
        <script src="src/pools.iife.js"></script>        <!-- Mode POOL -->
        <script src="src/chrono.iife.js"></script>       <!-- Mode CHRONO -->
        
        <!-- 5. Modules fonctionnels -->
        <script src="src/ranking.iife.js"></script>      <!-- Classements -->
        <script src="src/export.iife.js"></script>       <!-- Export/Print -->
        
        <!-- ============================================ -->
        <!-- FICHIER LEGACY (fonctions restantes a migrer) -->
        <!-- ============================================ -->
        <script src="script.js"></script>

    </body>
 </html>
